<!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-spring4-4.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
  <head th:replace="~{fragmentos :: cabecalho(${pageTitle})}" />
  <body>
    <div th:replace="~{fragmentos :: navegacao(${usuarioLogado})}"></div>

    <div class="container">
      <div th:replace="~{fragmentos :: saudacoes(${usuarioLogado})}" />

      <div class="row">
        <h1 th:text="${pageTitle}">Formul√°rio Slot</h1>
      </div>

      <div class="row">
        <form
          th:object="${slot}"
          th:action="${slot.id == null} ? @{/slots} : @{/slots/{id}(id=${slot.id})}"
          method="post"
        >
          <div class="mb-3" th:if="${slot.id != null}">
            <label for="id" class="form-label">Identificador:</label>
            <input
              id="id"
              class="form-control"
              type="text"
              th:value="${slot.id}"
              readonly
            />
          </div>

          <div class="mb-3 form-check">
            <input
              class="form-check-input"
              type="checkbox"
              th:field="*{ocupado}"
              id="ocupado"
            />
            <label for="ocupado" class="form-check-label"> Ocupado </label>
            <div class="text-danger" th:errors="*{ocupado}"></div>
          </div>

          <div class="mb-3">
            <label for="moto" class="form-label">Moto:</label>
            <select class="form-select" name="motoId" id="moto">
              <option value="">Selecione uma moto</option>
              <option
                th:each="moto : ${motos}"
                th:value="${moto.id}"
                th:selected="${slot.moto != null and slot.moto.id == moto.id}"
                th:text="${moto.modelo + ' - ' + moto.placa}"
              ></option>
            </select>
            <div
              class="text-danger"
              th:if="${#fields.hasGlobalErrors()}"
              th:each="erro : ${#fields.globalErrors}"
              th:text="${erro}"
            ></div>
            <div class="text-danger" th:errors="*{moto}"></div>
          </div>

          <input
            type="hidden"
            name="_csrf"
            th:value="${_csrf != null ? _csrf.token : ''}"
          />

          <input th:if="${slot.id != null}" type="hidden" th:field="*{id}" />

          <div class="mb-3">
            <button type="submit" class="btn btn-primary">
              <span th:if="${slot.id == null}">Criar Slot</span>
              <span th:if="${slot.id != null}">Atualizar Slot</span>
            </button>
            <a href="/slots" class="btn btn-secondary">Cancelar</a>
          </div>
        </form>
      </div>
    </div>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
