<!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-spring4-4.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
  <head th:replace="~{fragmentos :: cabecalho(${pageTitle})}" />
  <body>
    <div th:replace="~{fragmentos :: navegacao(${usuarioLogado})}"></div>

    <div class="container">
      <div th:replace="~{fragmentos :: saudacoes(${usuarioLogado})}" />

      <div class="row">
        <h1 th:text="${pageTitle}">Check-in</h1>
      </div>
      <div class="row">
        <div class="col-12">
          <form
            th:object="${checkin}"
            th:action="${checkinId} != null ? @{/checkins/{id}(id=${checkinId})} : @{/checkins}"
            method="post"
          >
            <input
              th:if="${checkinId} != null"
              type="hidden"
              name="_method"
              value="put"
            />
            <div class="mb-3">
              <label for="motoId" class="form-label">Moto</label>
              <select class="form-select" th:field="*{motoId}" id="motoId">
                <option value="">Selecione uma moto</option>
                <option
                  th:each="moto : ${motosElegiveis}"
                  th:value="${moto.id}"
                  th:text="${moto.modelo} + ' - ' + ${moto.placa}"
                ></option>
              </select>
              <div th:if="${#fields.hasErrors('motoId')}" class="text-danger">
                <span th:errors="*{motoId}"></span>
              </div>
            </div>

            <div class="mb-3">
              <label for="slotId" class="form-label">Slot</label>
              <select class="form-select" th:field="*{slotId}" id="slotId">
                <option value="">Selecione um slot</option>
                <option
                  th:each="slot : ${slotsLivres}"
                  th:value="${slot.id}"
                  th:text="${'Slot ' + slot.id}"
                ></option>
              </select>
              <div th:if="${#fields.hasErrors('slotId')}" class="text-danger">
                <span th:errors="*{slotId}"></span>
              </div>
            </div>

            <div class="mb-3">
              <label for="usuarioId" class="form-label"
                >Usuário responsável</label
              >
              <select
                class="form-select"
                th:field="*{usuarioId}"
                id="usuarioId"
              >
                <option value="">Selecione o usuário</option>
                <option
                  th:each="usuario : ${usuarios}"
                  th:value="${usuario.id}"
                  th:text="${usuario.nome}"
                ></option>
              </select>
              <div
                th:if="${#fields.hasErrors('usuarioId')}"
                class="text-danger"
              >
                <span th:errors="*{usuarioId}"></span>
              </div>
            </div>

            <div class="form-check mb-3">
              <input
                class="form-check-input"
                type="checkbox"
                th:field="*{violada}"
                id="violada"
              />
              <label class="form-check-label" for="violada">
                Placa violada?
              </label>
            </div>

            <div class="mb-3">
              <label for="observacao" class="form-label">Observação</label>
              <textarea
                class="form-control"
                th:field="*{observacao}"
                id="observacao"
                rows="3"
              ></textarea>
            </div>

            <div class="mb-3">
              <label for="imagens" class="form-label">Imagens (URLs)</label>
              <input
                class="form-control"
                type="text"
                th:field="*{imagens}"
                id="imagens"
              />
            </div>

            <div class="mb-3">
              <input
                type="hidden"
                name="_csrf"
                th:value="${_csrf != null ? _csrf.token : ''}"
              />
              <button type="submit" class="btn btn-primary">
                <span th:if="${checkinId} == null">Criar Check-in</span>
                <span th:if="${checkinId} != null">Atualizar Check-in</span>
              </button>
              <a href="/checkins" class="btn btn-secondary">Cancelar</a>
            </div>
          </form>
        </div>
      </div>
    </div>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
